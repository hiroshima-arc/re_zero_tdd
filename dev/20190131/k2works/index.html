<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0" name="viewport">
    <meta content="ie=edge" http-equiv="X-UA-Compatible">
    <title>Re:ゼロから始めるテスト駆動開発</title>
    <link href="https://cdn.rawgit.com/mochajs/mocha/2.2.5/mocha.css" rel="stylesheet" />
    <script src="https://cdn.rawgit.com/mochajs/mocha/2.2.5/mocha.js"></script>
    <script>
        mocha.setup("bdd");
    </script>
    <style type="text/css">
        body {
            width: 650px;
            margin: 0 auto;
            background-color: ivory;
        }

        header {
            width: 350px;
        }

        .nav-componet {
            width: 290px;
            float: left;
            padding: 5px;
            margin-bottom: 5px;
        }

        .nav-componet a {
            text-decoration: none;
            font-size: 15px;
        }

        .nav-componet a:link {
            color: #ff0000;
        }

        .nav-componet a:visited {
            color: #a0a0a0;
        }

        .nav-componet a:hover {
            color: #80ff00;
        }

        .nav-componet a:active {
            color: #0000ff;
        }

        .fizz-buzz-component {
            width: 340px;
            float: right;
            padding-left: 5px;
            padding-bottom: 10px;
            margin-bottom: 5px;
        }

        footer {
            clear: both;
            width: auto;
            text-align: center;
        }
    </style>
</head>

<body>
    <h1>HTML5+CSS+JavaScript with TDD</h1>
    <div class="nav-componet">
        <header>
            <nav>
                <h1>Menu</h1>
                <ul>
                    <li><a href="index.html">FizzBuzz</a></li>
                    <ul id="nav-component__sub-menu--fizz-buzz">
                        <li id="nav-component__sub-menu--call">
                            <a href="#">FizzBuzzCall</a>
                        </li>
                        <li id="nav-component__sub-menu--print">
                            <a href="#">FizzBuzzPrint</a>
                        </li>
                        <li id="nav-component__sub-menu--up-down">
                            <a href="#">FizzBuzzUpDown</a>
                        </li>
                    </ul>
                </ul>
            </nav>
        </header>
    </div>
    <section>
        <div class="fizz-buzz-component">
            <h1>FizzBuzz</h1>
            <article id="fizz-buzz-component__article--call">
                <h1>FizzBuzzCall</h1>
                <input type="text" id="fizz-buzz-component__input--call" onchange=fizzBuzzCall()>
                <input type="button" id="fizz-buzz-component__button--call" value="Call" onclick=fizzBuzzCall()>
            </article>
            <article id="fizz-buzz-component__article--print">
                <h1>FizzBuzzPrint</h1>
                <div id="fizz-buzz-component__print--message">Initialized</div>
                <input type="text" id="fizz-buzz-component__input--print" onchange=fizzBuzzPrint()>
                <input type="button" id="fizz-buzz-component__button--print" value="Print" onclick=fizzBuzzPrint()>
            </article>
            <article id="fizz-buzz-component__article--up-down">
                <h1>FizzBuzzUpDown</h1>
                <div id="fizz-buzz-component__up-down--message">Ready</div>
                <input type="button" id="fizz-buzz-component__button--down" value="-" onclick=fizzBuzzDown()>
                <input type="button" id="fizz-buzz-component__button--up" value="+" onclick=fizzBuzzUp()>
            </article>
            <article id="fizz-buzz-component__article--test">
                <div id="mocha"></div>
            </article>
        </div>
    </section>
    <footer>
        <p>Copyright</p>
        <address>hiroshima.arc@gmail.com</address>
    </footer>
    <script>
        function assert(actual, expected) {
            const message = `\nactual:` + actual + `\nexpected: ` + expected;
            console.log(".");
            console.assert(expected === actual, message);
            if (expected !== actual) {
                throw Error(message);
            }
        }

        describe("FizzBuzzTest", () => {
            it("1から100までプリントする、ただし3で割り切れる場合はFizz5で割り切れる場合はBuzz両方で割り切れる場合はFizzBuzzをプリントする", () => {
                const array = iterate();

                assert(array[0], 1);
                assert(array[2], 'Fizz');
                assert(array[4], 'Buzz');
                assert(array[14], 'FizzBuzz');
            });

            it("3で割り切れる場合はFizzをプリントする", () => {
                assert(fizzBuzz(3), 'Fizz');
                assert(fizzBuzz(1), 1);
            });

            it("5で割り切れる場合はBuzzをプリントする", () => {
                assert(fizzBuzz(5), 'Buzz');
            });

            it("3と5で割り切れる場合はFizzBuzzをプリントする", () => {
                assert(fizzBuzz(15), 'FizzBuzz');
            });
        });

        mocha.run();

        function iterate() {
            const array = [];
            [...Array(100).keys()].map((count) => {
                array.push(fizzBuzz(count + 1))
            });
            return array;
        }

        function print() {
            iterate().forEach((each) => {
                console.log(each)
            });
        }

        function isFizz(number) {
            return number % 3 === 0;
        }

        function isBuzz(number) {
            return number % 5 === 0;
        }

        function fizzBuzz(number) {
            if (isFizz(number) && isBuzz(number)) return 'FizzBuzz';
            if (isFizz(number)) return 'Fizz';
            if (isBuzz(number)) return 'Buzz';
            return number;
        }

        print();

        function fizzBuzzCall() {
            const value = Number.parseInt(document.getElementById("fizz-buzz-component__input--call").value);
            if (isNaN(value)) {
                alert("数字を入力してください");
            } else {
                alert(fizzBuzz(value));
            }
        }

        function fizzBuzzPrint() {
            const value = Number.parseInt(document.getElementById("fizz-buzz-component__input--print").value);
            const target = document.getElementById("fizz-buzz-component__print--message");

            if (isNaN(value)) {
                target.innerHTML = "数字を入力してください";
            } else {
                target.innerHTML = fizzBuzz(value);
            }
        }

        let count = 0;

        function fizzBuzzDown() {
            const target = document.getElementById("fizz-buzz-component__up-down--message");
            target.innerHTML = fizzBuzz(count);
            if (count > 0) {
                count -= 1;
            }
        }

        function fizzBuzzUp() {
            const target = document.getElementById("fizz-buzz-component__up-down--message");
            target.innerHTML = fizzBuzz(count);
            count += 1;
        }
    </script>

</body>

</html>